Refactor routes and controllers for improved structure and access control
